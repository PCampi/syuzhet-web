<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Syuzhet web app</title>
    <meta name="description" content="Web abb to extract emotions from narratives.">
    <meta name="author" content="Pietro Campi">
    <meta name="format-detection" content="telephone=no">

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
</head>

<body style="width: 100%; margin: 0 10% 0 10%;">
    <h1>Wellcome to Syuzhet web interface.</h1>
    <p>
        Fill the form below to start analyzing emotions in texts!
    </p>

    <form style="margin: 0 auto; width: 100%;" id="myForm">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="min-width: 80%">
            <textarea class="mdl-textfield__input" type="text" rows="3" id="text_input"
            name="content"></textarea>
            <label class="mdl-textfield__label" for="text_input">Text to analyze...</label>
        </div>

        <div>
            <input type="button"
            class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"
            value="Send text" id="send_text_button"/>
        </div>
    </form>

    <script>
        $(document).ready(function() {
            $('#send_text_button').on('click', function () {
                data_to_send = JSON.stringify({"content": String($("#text_input").val())})
                console.log(data_to_send);

                $.ajax({
                    url: 'http://127.0.0.1:8000/analyze',
                    cache: false,
                    type: 'POST',
                    data : data_to_send,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(json) {
                        console.log('Done!');
                        console.log(json);
                    },
                    error: function(req, textStatus, errorThrown) {
                        console.log(req);
                        console.log(textStatus);
                        console.log(errorThrown);
                    }
                });
            });
        });
    </script>
</body>

</html>
